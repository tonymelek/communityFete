(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(61),l=a.n(c),o=(a(69),a(3)),i=a(2),s=a(4),m=(a(70),Object(n.createContext)()),u=a(6),d=a.n(u),f={getUsers:function(e){return d()({method:"get",url:"/api/users",headers:{authorization:"bearer ".concat(e)}})},login:function(e,t){return d()({method:"post",url:"/api/login",data:{email:e.current.value,password:t.current.value}})},signup:function(e,t){return d()({method:"post",url:"/api/signup",data:{email:e.current.value,password:t.current.value}})},updateBalanceRole:function(e,t){return d()({method:"put",url:"/api/updateBalanceRole",headers:{authorization:"bearer ".concat(t)},data:e})},getShops:function(){return d()({method:"get",url:"/api/allshops"})},getMenu:function(e){return d()({method:"get",url:"/api/allmenu",headers:{authorization:"bearer ".concat(e)}})},getMenu_user:function(){return d()({method:"get",url:"/api/allmenu-users"})},createNewShop:function(e,t){return d()({method:"post",url:"/api/create-shop",headers:{authorization:"bearer ".concat(t)},data:e})},createMenuItem:function(e,t){return d()({method:"post",url:"/api/create-menu-item",headers:{authorization:"bearer ".concat(t)},data:e})},deleteMenuItem:function(e,t){return d()({method:"delete",url:"/api/delete-menu-item",headers:{authorization:"bearer ".concat(t)},data:e})},getThisUser:function(e){return d()({method:"get",url:"/api/get-this",headers:{authorization:"bearer ".concat(e)}})},processPayment:function(e,t){return d()({method:"post",url:"/api/processpayment",headers:{authorization:"bearer ".concat(t)},data:e})},getActiveOrders:function(e){return d()({method:"get",url:"/api/activeorders",headers:{authorization:"bearer ".concat(e)}})},getUserActiveOrders:function(e){return d()({method:"get",url:"/api/myactiveorders",headers:{authorization:"bearer ".concat(e)}})},getMerchantsPerShop:function(e){return d()({method:"get",url:"/api/merchants/".concat(e)})},getAdminStats:function(e){return d()({method:"get",url:"/api/admin-stats",headers:{authorization:"bearer ".concat(e)}})},getAdminFooter:function(e){return d()({method:"get",url:"/api/admin-footer",headers:{authorization:"bearer ".concat(e)}})}};a(88);function p(){var e=Object(n.useContext)(m).state.display;return r.a.createElement("div",{className:"notification animate__animated animate__bounceInDown  ".concat(e.color," ").concat(e.class)},r.a.createElement("p",{className:"p-3"},e.text))}a(89);function _(){return r.a.createElement("div",{className:"splash__main text-center animate__animated animate__zoomIn  d-flex flex-column justify-content-between"},r.a.createElement("div",null,r.a.createElement("h1",{className:" mt-4"},"Welcome"),r.a.createElement("h5",{className:" my-1"},"to"),r.a.createElement("img",{className:"d-block mx-auto",src:"./imgs/logo.png",alt:"logo"}),r.a.createElement("h3",{className:" my-1"},"Community Fete"),r.a.createElement("h1",null,"2021")),r.a.createElement("div",{className:"fete___photo__container"},r.a.createElement("img",{src:"./imgs/fete.png",alt:"fete",className:"fete__photo"})),r.a.createElement("p",null,"\xa9 Copyright 2021 , Developed by ",r.a.createElement("a",{href:"mailto:tonymelek.au@gmail.com",className:"text-purple"},"Tony Melek")))}function b(){var e=Object(n.useRef)(""),t=Object(n.useRef)(""),a=Object(s.f)(),c=Object(n.useContext)(m).dispatch,l=Object(n.useState)(!0),o=Object(i.a)(l,2),u=o[0],d=o[1];return Object(n.useEffect)(function(){setTimeout(function(){d(!1)},3e3)},[]),r.a.createElement("div",{className:"container "},u&&r.a.createElement(_,null),r.a.createElement("div",{className:"login__main"},r.a.createElement(p,null),!u&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"login card mx-auto p-3 mt-3"},r.a.createElement("h3",{className:"text-center mt-3"},"Login"),r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"login__email"},"Email"),r.a.createElement("input",{type:"email",name:"login__email",id:"login__email",ref:e,autoComplete:"email",placeholder:"your Email",className:"form-control"}),r.a.createElement("label",{htmlFor:"login__password"},"Password"),r.a.createElement("input",{type:"password",name:"login__password",id:"login__password",autoComplete:"current-password",ref:t,className:"form-control"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary my-2 w-100",onClick:function(n){return function(e,t,n){e.preventDefault(),f.login(t,n).then(function(e){c({type:"update_token",token:e.data.token}),c({type:"update_balance",balance:e.data.balance}),c({type:"update_role",role:e.data.role}),c({type:"update_email",email:e.data.email}),localStorage.setItem("conmmFete",e.data.token),c({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Logged-in Successfully"}}),a.push("/".concat(e.data.role)),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response.data)}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}(n,e,t)}},"Login"),r.a.createElement("p",{className:"fst-italic"},"If you do not have an account please Sign up first, You only need to enter your email and password")),r.a.createElement("button",{type:"submit",className:"btn btn-outline-primary my-2 w-100",onClick:function(n){return function(e,t,n){e.preventDefault(),f.signup(t,n).then(function(e){c({type:"update_token",token:e.data.token}),c({type:"update_balance",balance:e.data.balance}),c({type:"update_role",role:e.data.role}),c({type:"update_email",email:e.data.email}),localStorage.setItem("conmmFete",e.data.token),c({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Signed-up Successfully"}}),a.push("/".concat(e.data.role)),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response.data)}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}(n,e,t)}},"Sign Up")))))}var h=a(9);a(94);function y(){var e=Object(s.f)(),t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)([]),u=Object(i.a)(o,2),d=u[0],p=u[1],_=Object(n.useState)(""),b=Object(i.a)(_,2),h=b[0],y=b[1],E=Object(n.useContext)(m),v=E.dispatch,g=E.state,N={};Object(n.useEffect)(function(){""!==g.role&&("admin"!==g.role&&e.replace("/".concat(g.role)),f.getUsers(g.token).then(function(e){return l(e.data)}).catch(function(e){v({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){v({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}),f.getShops().then(function(e){return p(e.data)}).catch(function(e){v({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){v({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}))},[g]);var x=function(e,t,a){var n=c.filter(function(e){return e.email===t})[0];switch(a){case"role":n.role=e.target.value;break;case"balance":n.balance=parseInt(e.target.value);break;case"shop":n.ShopId=parseInt(e.target.value)}N[t]=n};return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"w-75 mx-auto"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"admin__search_input"},"Search Users"),r.a.createElement("input",{type:"text",autoComplete:"off",name:"admin__search_input",id:"admin__search_input",className:"form-control mb-2",onChange:function(e){return y(e.target.value)}}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex flex-row flex-wrap justify-content-around"},c.filter(function(e){return e.email.toLowerCase().includes(h.trim().toLowerCase())}).map(function(e){return r.a.createElement("div",{key:e.email,className:"admin__users  card m-2"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"text-center"}," ",e.email)),r.a.createElement("div",{className:"card-body d-flex flex-wrap justify-content-between align-items-center"},r.a.createElement("div",{className:"form-group d-flex justify-content-between align-items-center px-2 my-1 flex-grow-1"},r.a.createElement("p",{className:"px-2 m-0"},"Role "),r.a.createElement("select",{defaultValue:e.role,onChange:function(t){return x(t,e.email,"role")}},r.a.createElement("option",{value:"user"},"user"),r.a.createElement("option",{value:"merchant"},"merchant"))),"merchant"===e.role?r.a.createElement("div",{className:"form-group d-flex justify-content-between align-items-center p-2 my-2 flex-grow-1"},r.a.createElement("p",{className:"px-2 m-0"},"Shop "),r.a.createElement("select",{onChange:function(t){return x(t,e.email,"shop")}},r.a.createElement("option",{value:""}),d.map(function(t){return r.a.createElement("option",{key:"shop-".concat(t.id),value:t.id,selected:e.ShopId===t.id},t.name)}))):null,"user"===e.role?r.a.createElement("div",{className:"d-flex flex-row justify-content-between align-items-center my-2 p-2 flex-grow-1"},r.a.createElement("p",{className:"px-2 m-0"},"Top up Balance"),r.a.createElement("input",{type:"number",name:"user__topup",onChange:function(t){return x(t,e.email,"balance")},className:"admin__user__topup"})):null,r.a.createElement("button",{type:"submit",className:"btn btn-warning w-100",onClick:function(t){return function(e,t){e.preventDefault(),N[t]&&("merchant"===N[t].role?N[t].balance=0:N[t].ShopId=null,f.updateBalanceRole(N[t],g.token).then(function(e){v({type:"notifier",display:{class:"d-block",color:"bg-success",text:"User Updated Successfully"}}),setTimeout(function(){v({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){v({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){v({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}))}(t,e.email,e.balance)}},"Update")))}))))}function E(){var e=["Hot Food","Beverage","Kids","Deserts"].sort(),t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],l=a[1],u=Object(n.useState)({name:"",category:e[0]}),d=Object(i.a)(u,2),p=d[0],_=d[1],b=Object(n.useContext)(m),h=b.dispatch,y=b.state,E=Object(s.f)();Object(n.useEffect)(function(){""!==y.role&&("admin"!==y.role&&E.replace("/".concat(y.role)),f.getShops().then(function(e){return l(e.data)}).catch(function(e){h({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){h({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}))},[y]);return r.a.createElement("div",null,r.a.createElement("div",{className:"w-100 mx-auto"},r.a.createElement("div",{className:"card p-2"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"new__shop__name"},"Shop Name"),r.a.createElement("input",{type:"text",className:"form-control",name:"new__shop__name",id:"new__shop__name",onChange:function(e){return _(Object(o.a)({},p,{name:e.target.value.trim()}))}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"select__category"},"Category"),r.a.createElement("select",{name:"select__category",defaultValue:e[0],id:"select__category",className:"form-select",onChange:function(e){return _(Object(o.a)({},p,{category:e.target.value}))}},e.map(function(e,t){return r.a.createElement("option",{key:"category-".concat(t),value:e},e)}))),r.a.createElement("button",{className:"btn btn-primary my-3 ",type:"submit",onClick:function(){if(p.name.trim().length<2)return h({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Shop name can't be empty"}}),void setTimeout(function(){h({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3);f.createNewShop(p,y.token).then(function(t){_({name:"",category:e[0]}),h({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Shop created Successfully"}}),setTimeout(function(){h({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){h({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){h({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}},"Create Shop"))),r.a.createElement("h3",{className:"text-center my-3"},"Shops List"),r.a.createElement("div",{className:"card p-2 my-2"},r.a.createElement("ul",{className:"d-flex flex-wrap list-unstyled"},e.map(function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{className:"w-100",key:t},e),c.filter(function(t){return t.category===e}).map(function(e){return r.a.createElement("li",{key:"shops-".concat(e.id),className:"px-2 m-2 d-inline-flex bg-danger border-success rounded text-light"},e.name)}))}))))}var v=a(29),g=a(20),N=a(23);function x(e){var t=e.state,a=e.sideDisplay,n=a.side,c=a.setSide,l=Object(s.f)();return r.a.createElement("div",{className:"header__main "},r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement(v.a,{className:"BiMenu",onClick:function(){return c("d-none"===n?"d-block animate__animated animate__fadeInDown":"d-none")}}),r.a.createElement("div",{className:"d-flex align-items-center justify-content-center"},r.a.createElement("div",{className:"d-flex align-items-center cursor-pointer",onClick:function(){return l.push("/".concat(t.role))}},r.a.createElement(g.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"}," ",t.user_email," ")),r.a.createElement("div",{className:"d-flex flex-column p-1 align-items-center  justify-content-center cursor-pointer",onClick:function(){localStorage.removeItem("conmmFete"),l.replace("/")}},r.a.createElement(N.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"py-1 m-0"},"Logout")))))}a(95);function O(e){var t=e.side,a=e.items;return r.a.createElement("div",{className:"side__menu ".concat(t.side)},a.map(function(e){return r.a.createElement("div",{key:e,className:"side__menu__item py-2 px-5 m-2"},r.a.createElement("a",{href:"#".concat(e),onClick:function(){return t.setSide("d-none"===t.side?"d-block animate__animated animate__fadeInDown":"d-none")}},e.split("-").join(" ")))}))}var j=a(7);function S(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return l=e.done,e},e:function(e){o=!0,c=e},f:function(){try{l||null==a.return||a.return()}finally{if(o)throw c}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function w(e){var t=e.state,a=Object(n.useState)({}),c=Object(i.a)(a,2),l=c[0],s=c[1];return Object(n.useEffect)(function(){""!==t.token&&f.getAdminStats(t.token).then(function(e){var t=e.data;if(t.spend=e.data.totalSpend[0].total,1===e.data.highestSpender.length){var a=e.data.highestSpender[0];t.highestSpenderEmail=a.User.email,t.highestSpenderTotal=a.total}else t.highestSpenderEmail="no purchases yet",t.highestSpenderTotal=0;var n,r=t.orders,c={},l=S(Object(j.a)(new Set(r.map(function(e){return e.order_custom_id}))));try{var o=function(){var e=n.value,t=r.find(function(t){return t.order_custom_id===e});c[t.Shop.name]?(c[t.Shop.name].total+=t.order_total,c[t.Shop.name].orders++):c[t.Shop.name]={total:t.order_total,orders:1}};for(l.s();!(n=l.n()).done;)o()}catch(d){l.e(d)}finally{l.f()}console.log(c);var i,m=0;for(var u in c)c[u].total>m&&(m=c[u].total,i=u,c[u].orders);t.bestShop=c[i],t.bestShopName=i,s(t)}).catch(function(e){return console.log(e)})},[t]),r.a.createElement("div",{className:"admin__dashboard__main text-center"},r.a.createElement("h3",{className:"py-3"},"Admin Dashboard"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around pt-4"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Users"),r.a.createElement("h1",{className:"display-4  mt-4 text-danger"},l.numberOfUsers)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Merchants"),r.a.createElement("h1",{className:"mt-4 text-primary display-4"},l.numberOfMerchants)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Orders"),r.a.createElement("h1",{className:"display-4  mt-4 text-primary"},l.numberOfOrders)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Revenue"),r.a.createElement("h1",{className:"mt-4"},"$",r.a.createElement("span",{className:"display-4 text-danger"},l.spend>0?l.spend:0))),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Best Selling Shop"),r.a.createElement("h2",{className:"text-danger mt-2"},l.bestShopName),r.a.createElement("h3",null,"Orders# ",Object(o.a)({},l.bestShop).orders),r.a.createElement("h3",null,"Sales: $",r.a.createElement("span",{className:"text-danger"},Object(o.a)({},l.bestShop).total))),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Highest Spending User"),r.a.createElement("h2",{className:"mt-4"},l.highestSpenderEmail),r.a.createElement("h3",null,"Spent : $",r.a.createElement("span",{className:"text-danger"},l.highestSpenderTotal)))))}var I=a(24);function C(e){var t=e.state,a=Object(n.useState)({}),c=Object(i.a)(a,2),l=c[0],o=c[1],m=Object(s.f)();Object(n.useEffect)(function(){t.token.length<20||f.getAdminFooter(t.token).then(function(e){o(e.data)})},[t]);return r.a.createElement("div",{className:"merchant__footer__main py-2"},r.a.createElement("div",{className:"d-flex justify-content-around"},r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(I.b,{className:"FcShop"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null,l.shops," ")," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(g.c,{className:"GrDocumentTime "}),r.a.createElement("p",{className:"p-0 my-0 mx-2"}," ",r.a.createElement("strong",null," ",l.users)," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center",onClick:function(){m.push("/create-admin")}},r.a.createElement(N.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},"Create Admin "))))}function T(){var e=Object(n.useState)("d-none"),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(s.f)(),o=Object(n.useContext)(m),u=o.dispatch,d=o.state;return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?f.getThisUser(e).then(function(e){u({type:"update_token",token:e.data.token}),u({type:"update_balance",balance:e.data.balance}),u({type:"update_role",role:e.data.role}),u({type:"update_email",email:e.data.email})}).catch(function(e){return console.warn(e)}):l.replace("/")},[]),r.a.createElement("div",{className:"container admin__main"},r.a.createElement(p,null),r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(x,{state:d,sideDisplay:{side:a,setSide:c}}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement(O,{side:{side:a,setSide:c},items:["Dashboard","Manage-Shops","Manage-Users"]}),r.a.createElement("div",{className:"admin__component mx-2 mb-10",id:"Dashboard"},r.a.createElement(w,{state:d})),r.a.createElement("div",{className:"admin__component mx-2 mb-10",id:"Manage-Shops"},r.a.createElement(E,null)),r.a.createElement("div",{className:"admin__component mx-2 mb-10",id:"Manage-Users"},r.a.createElement(y,null))),r.a.createElement(C,{state:d})))}function A(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return l=e.done,e},e:function(e){o=!0,c=e},f:function(){try{l||null==a.return||a.return()}finally{if(o)throw c}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function F(e){var t,a=e.orders,n=(Object(j.a)(new Set(a.map(function(e){return e.order_custom_id}))),{}),c={},l=0,o=0,i=A(a);try{for(i.s();!(t=i.n()).done;){var s=t.value;n[s.Menu.item_name]?n[s.Menu.item_name]+=s.item_qty:n[s.Menu.item_name]=s.item_qty,c[s.order_custom_id]?c[s.order_custom_id].items.push(s):(c[s.order_custom_id]={},c[s.order_custom_id].items=[s],c[s.order_custom_id].total=s.order_total,"received"!==s.order_status&&(l++,o+=s.order_total))}}catch(f){i.e(f)}finally{i.f()}console.log(c,l);var m,u=0;for(var d in n)n[d]>u&&(u=n[d],m=d);return r.a.createElement("div",{className:"user__dashboard__main text-center"},r.a.createElement("h3",{className:"py-3"},"User Dashboard"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around pt-4"},r.a.createElement("div",{className:"d-flex flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Orders"),r.a.createElement("h1",{className:"display-4  mt-4 text-danger"},Object.keys(c).length)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Favourite"),r.a.createElement("h3",{className:"mt-4 text-primary"},m))),r.a.createElement("div",{className:"d-flex  flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Active Orders"),r.a.createElement("h1",{className:"display-4  mt-4 text-primary"},l)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Spent"),r.a.createElement("h1",{className:"mt-4"},"$",r.a.createElement("span",{className:"display-4 text-danger"},o))))))}var D=a(30);function q(){var e=Object(n.useContext)(m),t=e.state,a=e.dispatch,c=t.basket,l=Object(n.useState)(0),o=Object(i.a)(l,2),s=o[0],u=o[1];return Object(n.useEffect)(function(){var e=0;for(var t in c)e+=c[t].qty*c[t].price;u(e)},[t]),Object(n.useEffect)(function(){a({type:"update_orderTotal",orderTotal:s})},[s]),r.a.createElement("div",{className:"user__header2__main py-2"},r.a.createElement("div",{className:"d-flex justify-content-around"},r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(g.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null,Object.keys(t.basket).length," ")," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(I.a,{className:"AiOutlineDollar "}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},"Total:",r.a.createElement("strong",null,"$",s," ")," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(D.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null," $")," ",t.balance))))}function U(e){var t=e.history,a=Object(n.useContext)(m),c=a.dispatch,l=a.state,s=Object(n.useState)([]),u=Object(i.a)(s,2),d=u[0],p=u[1],_=["d-none","d-block"],b=l.basket,h=Object(n.useState)(""),y=Object(i.a)(h,2),E=y[0],g=y[1],N=Object(n.useState)([]),x=Object(i.a)(N,2),O=x[0],S=x[1];Object(n.useEffect)(function(){f.getMenu_user().then(function(e){p(e.data.map(function(e){return Object(o.a)({},e,{expand:!1,qty:0})})),S(Object(j.a)(new Set(e.data.filter(function(e){return e.item_name.toLowerCase()}).map(function(e){return e.Shop.category}))))}).catch(function(e){return console.log(e.response)})},[]);var k=function(e,t){p(d.map(function(a){if(a.id===e){var n=Object(o.a)({},a,{qty:"+"===t?a.qty+1:a.qty-1});return n.qty>0?(b[e]={id:e,qty:n.qty,item_name:n.item_name,price:n.price,ShopId:n.ShopId},n):(n=Object(o.a)({},a,{qty:0}),delete b[e],n)}return a})),c({type:"updateBasket",basket:b})};return r.a.createElement("div",{className:"user__menu__main px-4 "},r.a.createElement("form",{autoComplete:"off",onSubmit:function(e){return function(e){e.preventDefault()}(e)}},r.a.createElement("div",{className:"form-group my-2 pt-3 d-flex align-items-end"},r.a.createElement("div",{className:"flex-grow-1  mx-2"},r.a.createElement("label",{htmlFor:"search-item"},"Filter Items"),r.a.createElement("input",{type:"text",name:"search-item",value:E,id:"search-item",className:"form-control",onChange:function(e){g(e.target.value.trim().toLowerCase()),S(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(j.a)(new Set(d.filter(function(t){return t.item_name.toLowerCase().includes(e)}).map(function(e){return e.Shop.category})))}(e.target.value))}})),r.a.createElement("button",{className:"btn btn-primary mx-2",type:"submit"},r.a.createElement(v.b,null)))),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex flex-column justify-content-between"},r.a.createElement("div",{className:"user__menu__items"},O.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"card  bg-dark my-2 p-2   text-light cursor-pointer",onClick:function(){p(d.map(function(t){return t.Shop.category===e?Object(o.a)({},t,{expand:!t.expand}):t}))}},r.a.createElement("h5",null,e)),d.filter(function(e){return e.item_name.toLowerCase().includes(E)}).filter(function(t){return t.Shop.category===e}).map(function(e){return r.a.createElement("div",{key:e.id,className:"card  my-2 p-2 d-flex flex-row flex-wap justify-content-between animate__animated   animate__zoomIn ".concat(_[e.expand?1:0])},r.a.createElement("div",null,r.a.createElement("p",{className:"my-1"},r.a.createElement("strong",null,e.item_name),"-",e.serve),r.a.createElement("p",{className:"my-1"},e.item_desc),r.a.createElement("p",{className:"my-2"},"(",e.unit,") $",e.price),r.a.createElement("div",{className:"d-flex"},r.a.createElement("button",{className:"btn btn-dark",onClick:function(){return k(e.id,"-")}},"<"),r.a.createElement("input",{type:"number",value:e.qty,onChange:function(t){return function(e,t){var a=t.id,n=t.item_name,r=t.price,l=t.ShopId,i=parseInt(e.target.value);p(d.map(function(e){return e.id===a?Object(o.a)({},e,{qty:i}):e})),i>0?b[a]={id:a,qty:i,item_name:n,price:r,ShopId:l}:(p(d.map(function(e){return e.id===a?Object(o.a)({},e,{qty:0}):e})),delete b[a]),c({type:"updateBasket",basket:b})}(t,e)},className:"form-control mx-2 input__qty"}),r.a.createElement("button",{className:"btn btn-dark",onClick:function(){return k(e.id,"+")}},">"))),r.a.createElement("div",null,r.a.createElement("img",{src:e.item_pic,width:"100",alt:e.item_name})))}))})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",onClick:function(e){return function(e){if(e.preventDefault(),0===Object.keys(l.basket).length)return c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"You need to have at least one item in basket to proceed"}}),void setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3);t.push("/checkout")}(e)},className:"btn btn-success w-100 mb-3"},"Check out"))))}a(96);var z=a(14),$=a.n(z);a(123);function B(e){var t=e.loading;return r.a.createElement("div",{className:"loading__main"},t&&r.a.createElement("img",{src:"./imgs/loading.gif",alt:"loading"}))}function P(){var e=Object(n.useContext)(m),t=e.dispatch,a=e.state,c=Object(n.useState)([]),l=Object(i.a)(c,2),u=l[0],d=l[1],_=Object(n.useState)([]),b=Object(i.a)(_,2),h=b[0],y=b[1],E=!1,v=Object(s.f)(),g=Object(n.useState)("d-none"),N=Object(i.a)(g,2),j=N[0],S=N[1],k=Object(n.useState)(!0),w=Object(i.a)(k,2),I=w[0],C=w[1];return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?f.getThisUser(e).then(function(e){t({type:"update_token",token:e.data.token}),t({type:"update_balance",balance:e.data.balance}),t({type:"update_role",role:e.data.role}),t({type:"update_email",email:e.data.email})}).catch(function(e){return console.warn(e)}):v.replace("/")},[]),Object(n.useEffect)(function(){if(""!==a.user_email&&!E){""!==a.role&&"user"!==a.role&&v.replace("/".concat(a.role)),E=!0;var e=$()();return f.getMenu_user().then(function(e){y(e.data.map(function(e){return Object(o.a)({},e,{expand:!1,qty:0})}))}).catch(function(e){return console.log(e.response)}),e.emit("userId",a.user_email),e.on("userOrders",function(e){d(e),C(!1)}),e.on("activeOrders",function(e){d(e)}),e.emit("newOrder",u),function(){e.disconnect()}}},[a]),r.a.createElement("div",{className:"container user__main"},r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(p,null),r.a.createElement(B,{loading:I}),r.a.createElement(x,{state:a,sideDisplay:{side:j,setSide:S}}),r.a.createElement("div",{className:"flex__main__components ".concat(I?"hazy":"")},r.a.createElement(O,{side:{side:j,setSide:S},items:["Dashboard","Order-now"]}),r.a.createElement("div",{className:"pt-4 user__dashboard",id:"Dashboard"},r.a.createElement(F,{orders:u,menu:h})),r.a.createElement("div",{id:"Order-now",className:"pt-2"},r.a.createElement(U,{history:v}))),r.a.createElement(q,null)))}function L(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-center"},"Page is not found or you not allowed to view this page"))}a(124),a(125);function R(e){var t=e.values,a=Object(n.useState)({item_name:"",item_desc:"",unit:"each",serve:"sandwitch",price:0}),c=Object(i.a)(a,2),l=c[0],s=c[1],u=Object(n.useContext)(m),d=u.dispatch,p=u.state,_=Object(n.useState)(null),b=Object(i.a)(_,2),h=b[0],y=b[1];return r.a.createElement("div",{className:"create__menu__item ".concat(t.create_appear)},r.a.createElement("div",{className:"card m-3 create__menu__item__card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("p",{onClick:function(){t.setCreate_appear("d-none")},className:"text-right"},"X"),r.a.createElement("h4",{className:"text-center"},"Create New Menu Item")),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault();var a=l.item_name,n=l.item_desc,r=(l.unit,l.serve,l.price),c=new FormData;if(c.append("userPhoto",h),c.append("data",JSON.stringify(l)),a.length<2||n.length<2||r<=0)return d({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"All Fields are Mandatory, please fill and re-submit"}}),void setTimeout(function(){d({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3);f.createMenuItem(c,p.token).then(function(e){d({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Item created Successfully"}}),setTimeout(function(){d({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3),t.setCreate_appear("d-none")}).catch(function(e){d({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Error creating new Item"}}),setTimeout(function(){d({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}(e)}},r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_name"},"Item Name"),r.a.createElement("input",{type:"text",className:"form-control",name:"create_menu_name",id:"create_menu_name",onChange:function(e){return s(Object(o.a)({},l,{item_name:e.target.value.trim()}))}})),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_desc"},"Item Description"),r.a.createElement("input",{type:"text",className:"form-control",name:"create_menu_desc",id:"create_menu_desc",onChange:function(e){return s(Object(o.a)({},l,{item_desc:e.target.value.trim()}))}})),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_pic"},"Item Picture"),r.a.createElement("input",{type:"file",id:"photo",name:"file",className:"form-control",onChange:function(e){return function(e){y(e.target.files[0])}(e)}})),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:""},"Unit"),r.a.createElement("select",{defaultValue:"each",className:"form-select",name:"create_menu_unit",id:"create_menu_unit",onChange:function(e){return s(Object(o.a)({},l,{unit:e.target.value}))}},r.a.createElement("option",{value:"each"},"each"),r.a.createElement("option",{value:"100g"},"100g"))),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_serve"},"Serve"),r.a.createElement("select",{className:"form-select",name:"create_menu_serve",id:"create_menu_serve",onChange:function(e){return s(Object(o.a)({},l,{serve:e.target.value}))}},r.a.createElement("option",{value:"sandwitch"},"sandwitch"),r.a.createElement("option",{value:"cup"},"cup"),r.a.createElement("option",{value:"box"},"box"),r.a.createElement("option",{value:"ticket"},"ticket"))),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_price"},"Price"),r.a.createElement("input",{type:"number",className:"form-control",name:"create_menu_price",id:"create_menu_price",onChange:function(e){return s(Object(o.a)({},l,{price:e.target.value}))}})),r.a.createElement("button",{className:"btn btn-primary m-2",type:"submit"},"Create Item"))))}function W(e){var t=e.myOrders,a=(e.menu,Object(j.a)(new Set(t.map(function(e){return"received"!==e.order_status?e.order_custom_id:null}).filter(function(e){return null!==e})))),n=function(e,t,a){e.preventDefault(),$()().emit("updateOrderStatus",{id:t,status:a})};return r.a.createElement("div",{className:"merchant__manage__orders__main"},r.a.createElement("h3",{className:"text-center py-3"},"Manage Orders"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around"},r.a.createElement("div",{className:"d-flex flex-wrap justify-content-center"},a.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"card  myorder__items m-2 "},r.a.createElement("div",{className:"card-header bg-header"},r.a.createElement("h4",{className:"text-center"},"Order#",r.a.createElement("span",{className:"text-danger"}," ",e," "),"- Shop: ",r.a.createElement("span",{className:"text-primary"},Object(o.a)({},Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).Shop).name))),r.a.createElement("div",{className:"card-body  ".concat("paid"===Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status?"bg-paid":"bg-ready")},r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement("div",{className:"d-flex  justify-content-between myorder__items"},r.a.createElement("div",null,r.a.createElement("h5",{className:"m-1 p-0"},"Items"),t.filter(function(t){return t.order_custom_id===e}).map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("ul",{className:"p-1 m-0 list-unstyled"},r.a.createElement("li",null,r.a.createElement(r.a.Fragment,null,e.Menu.item_name,"x",e.item_qty))))})),r.a.createElement("div",null,r.a.createElement("h1",null,"$",Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_total),r.a.createElement("h5",null,"\u2022 ",Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status))),r.a.createElement("div",null,"paid"===Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status&&r.a.createElement("button",{className:"btn btn-warning d-block w-100 my-2",onClick:function(t){return n(t,e,"ready")}},"Ready"),"ready"===Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status&&r.a.createElement("button",{className:"btn btn-success d-block w-100 my-2",onClick:function(t){return n(t,e,"received")}},"Collected"))))))}))))}function J(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useContext)(m),o=l.dispatch,s=l.state;Object(n.useEffect)(function(){""!==s.token&&f.getMenu(s.token).then(function(e){c(e.data)}).catch(function(e){return console.log(e.response)})},[s]);return r.a.createElement("div",{className:"mb-10 merchant__menu__main"},r.a.createElement("h3",{className:"text-center py-3"},"Menu Items"),a.filter(function(e){return e.availability}).map(function(e){return r.a.createElement("div",{key:e.id,className:"card m-2 p-2 d-flex flex-row flex-wap justify-content-between"},r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("strong",null,e.item_name)," - ",e.item_desc),r.a.createElement("p",null,e.unit,"-",e.serve,"-$",e.price),r.a.createElement("button",{onClick:function(t){return function(e,t){e.preventDefault(),f.deleteMenuItem({item_id:t},s.token).then(function(e){c(a.map(function(e){return e.id===t&&(e.availability=!1),e})),o({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Item deleted Successfully"}}),setTimeout(function(){o({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){o({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Error deleting Item"}}),setTimeout(function(){o({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3),console.log(e.response.data)})}(t,e.id)},className:"btn btn-danger",type:"submit"},"Delete Item")),r.a.createElement("div",null,r.a.createElement("img",{src:e.item_pic,height:"80",alt:e.item_name})))}))}var Y=a(63);function V(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return G(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return G(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return l=e.done,e},e:function(e){o=!0,c=e},f:function(){try{l||null==a.return||a.return()}finally{if(o)throw c}}}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function H(e){var t,a="",n={},c={},l=0,o=0,i=V(e.orders);try{for(i.s();!(t=i.n()).done;){var s=t.value;a=s.Shop.name,n[s.Menu.item_name]?n[s.Menu.item_name]+=s.item_qty:n[s.Menu.item_name]=s.item_qty,c[s.order_custom_id]?c[s.order_custom_id].items.push(s):(c[s.order_custom_id]={},c[s.order_custom_id].items=[s],c[s.order_custom_id].total=s.order_total,o+=s.order_total,"received"!==s.order_status&&l++)}}catch(m){i.e(m)}finally{i.f()}return r.a.createElement("div",{className:"merchant__footer__main py-2"},r.a.createElement("div",{className:"d-flex justify-content-around"},r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(I.b,{className:"FcShop"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null," ",a)," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(Y.a,{className:"GrDocumentTime "}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},"Active : ",r.a.createElement("strong",null," ",l)," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(D.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null," $",o)," "))))}a(126);function K(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return X(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return X(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return l=e.done,e},e:function(e){o=!0,c=e},f:function(){try{l||null==a.return||a.return()}finally{if(o)throw c}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Q(e){var t,a=e.orders,c=e.menu,l=e.state,o=Object(n.useState)(0),s=Object(i.a)(o,2),m=s[0],u=s[1],d=Object(j.a)(new Set(a.map(function(e){return e.order_custom_id}))),p={},_=K(a);try{for(_.s();!(t=_.n()).done;){var b=t.value;p[b.Menu.item_name]?p[b.Menu.item_name]+=b.item_qty:p[b.Menu.item_name]=b.item_qty}}catch(v){_.e(v)}finally{_.f()}var h,y=0;for(var E in p)p[E]>y&&(y=p[E],h=E);return Object(n.useEffect)(function(){""!==l.user_email&&f.getMerchantsPerShop(l.user_email).then(function(e){u(e.data.merchantsCount)}).catch(function(e){return console.log(e)})},[l]),r.a.createElement("div",{className:"merchant__dasboard__main text-center"},r.a.createElement("h3",{className:"text-center py-3"},"Merchant Dashboard"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around pt-4"},r.a.createElement("div",{className:"d-flex flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Orders"),r.a.createElement("h1",{className:"display-1 mt-4 text-danger"},d.length)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Best Seller"),r.a.createElement("h2",{className:"mt-3 text-primary"},h),r.a.createElement("h5",null,"Sold: ",y))),r.a.createElement("div",{className:"d-flex  flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Menu Items"),r.a.createElement("h1",{className:"display-1 mt-4 text-primary"},c.filter(function(e){return e.availability}).length)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Merchants"),r.a.createElement("h1",{className:"display-1 mt-4 text-danger"},m)))))}function Z(){var e=Object(n.useContext)(m),t=e.dispatch,a=e.state,c=Object(n.useState)("d-none"),l=Object(i.a)(c,2),o=l[0],u=l[1],d=Object(n.useState)("d-none"),_=Object(i.a)(d,2),b=_[0],h=_[1],y=Object(s.f)(),E=Object(n.useState)([]),v=Object(i.a)(E,2),g=v[0],N=v[1],j=Object(n.useState)([]),S=Object(i.a)(j,2),k=S[0],w=S[1],I=!1;return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?f.getThisUser(e).then(function(e){t({type:"update_token",token:e.data.token}),t({type:"update_balance",balance:e.data.balance}),t({type:"update_role",role:e.data.role}),t({type:"update_email",email:e.data.email})}).catch(function(e){return console.warn(e)}):y.replace("/")},[]),Object(n.useEffect)(function(){if(""!==a.role&&"merchant"!==a.role&&y.replace("/".concat(a.role)),""!==a.token&&!I){I=!0;var e=$()();return f.getMenu(a.token).then(function(e){N(e.data)}).catch(function(e){return console.log(e.response)}),e.emit("userId",a.user_email),e.on("shopConnection",function(e){console.log(e)}),e.on("oldOrders",function(e){w(e)}),function(){return e.disconnect()}}},[a]),r.a.createElement("div",{className:"container merchant__main"},r.a.createElement(p,null),r.a.createElement(R,{values:{create_appear:o,setCreate_appear:u}}),r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(x,{state:a,sideDisplay:{side:b,setSide:h}}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement(O,{side:{side:b,setSide:h},items:["Dashboard","Manage-Orders","Update-Menu"]}),r.a.createElement("div",{className:" mx-2 merchant__section mb-10",id:"Dashboard"},r.a.createElement(Q,{orders:k,menu:g,state:a})),r.a.createElement("div",{className:" mx-2 merchant__section mb-10",id:"Manage-Orders"},r.a.createElement(W,{myOrders:k,menu:g})),r.a.createElement("div",{className:" merchant__section mb-10",id:"Update-Menu"},r.a.createElement("button",{onClick:function(){return u("d-block animate__animated animate__zoomIn ")},className:"btn btn-outline-danger create__new__item__button cursor-pointer"},"Create New Menu Item "),r.a.createElement(J,null))),r.a.createElement(H,{orders:k})))}a(127),a(128);function ee(e){var t=e.props,a=t.state,c=t.dispatch,l=t.history,s=t.socketIOClient,m=Object(n.useState)([]),u=Object(i.a)(m,2),d=u[0],p=u[1],_=Object(n.useState)({}),b=Object(i.a)(_,2),h=b[0],y=b[1],E=Object(n.useState)({}),v=Object(i.a)(E,2),g=v[0],N=v[1],x=[],O={},j={};Object(n.useEffect)(function(){for(var e in a.basket){x.push(a.basket[e]);var t=Object(o.a)({},a.basket[e]);O[t.ShopId]?(O[t.ShopId].push({id:t.id,qty:t.qty}),j[t.ShopId]+=t.qty*t.price):(O[t.ShopId]=[{id:t.id,qty:t.qty}],j[t.ShopId]=t.qty*t.price)}p(x),y(O),N(j)},[a]);return r.a.createElement("div",{className:"revise__items__main d-flex flex-column justify-content-between"},r.a.createElement("div",{className:"resvise__items__list"},r.a.createElement("h2",null,"Items in Basket"),d.map(function(e){return r.a.createElement("div",{key:e.id,className:"card d-flex flex-row justify-content-between align-items-center p-2 m-1"},r.a.createElement("p",{className:"revised-item-width p-0 m-0"},r.a.createElement("strong",null,e.item_name)," x ",e.qty),r.a.createElement("p",{className:"p-0 m-0"},r.a.createElement("strong",null,"$"),e.qty*e.price," "),r.a.createElement("button",{className:"btn btn-danger",onClick:function(t){return function(e,t){e.preventDefault();var n=a.basket;delete n[t],c({type:"updateBasket",basket:n})}(t,e.id)},type:"submit"},"Remove"))})),r.a.createElement("div",{className:"checkout__button"},r.a.createElement("p",{className:"text-danger "}," **You may go back to edit quantities if required"),r.a.createElement("button",{className:"btn btn-success w-100",type:"submit",onClick:function(e){return function(e){if(e.preventDefault(),0===a.orderTotal)return c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Total should not be zero, you will be redirected to main page"}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3),l.replace("/user");var t=s();a.balance>=a.orderTotal?(f.processPayment({orders:JSON.stringify(h),subTotal:g,total:a.orderTotal},a.token).then(function(e){console.log(e.data),t.emit("newOrder",e.data),t.disconnect()}).catch(function(e){return console.log(e.response)}),c({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Order Processed Successfully"}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}}),l.replace("/order-tracker")},2e3),c({type:"updateBasket",basket:{}})):(c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Your Balance is insufficient"}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3))}(e)}},"Pay Now \xa0\xa0\xa0\xa0$",a.orderTotal)))}function te(e){var t=e.state,a=Object(s.f)();return r.a.createElement("div",{className:"header__main "},r.a.createElement("div",{className:"d-flex justify-content-end header__flex__container"},r.a.createElement("div",{className:"d-flex align-items-center justify-content-center"},r.a.createElement("div",{className:"d-flex align-items-center cursor-pointer",onClick:function(){return a.push("/user")}},r.a.createElement(g.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"}," ",t.user_email," ")),r.a.createElement("div",{className:"d-flex flex-column p-1 align-items-center justify-content-center cursor-pointer",onClick:function(){localStorage.removeItem("conmmFete"),a.replace("/")}},r.a.createElement(N.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"py-1 m-0"},"Logout")))))}function ae(){var e=Object(n.useContext)(m),t=e.dispatch,a=e.state,c=Object(n.useState)([]),l=Object(i.a)(c,2),o=l[0],u=l[1],d=!1,_=Object(s.f)();return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?f.getThisUser(e).then(function(e){t({type:"update_token",token:e.data.token}),t({type:"update_balance",balance:e.data.balance}),t({type:"update_role",role:e.data.role}),t({type:"update_email",email:e.data.email})}).catch(function(e){return console.warn(e)}):_.replace("/")},[]),Object(n.useEffect)(function(){if(""!==a.user_email&&!d){""!==a.role&&"user"!==a.role&&_.replace("/".concat(a.role)),d=!0;var e=$()();return e.emit("userId",a.user_email),e.on("userOrders",function(e){u(e)}),e.on("activeOrders",function(e){u(e)}),e.emit("newOrder",o),function(){e.disconnect()}}},[a]),r.a.createElement("div",{className:"container user__main"},r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(p,null),r.a.createElement(te,{state:a}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement("div",{className:"pt-2 px-2 user__revise"},r.a.createElement(ee,{props:{state:a,dispatch:t,history:_,socketIOClient:$.a}})),r.a.createElement("div",{id:"Order-now",className:"pt-4"})),r.a.createElement(q,null)))}function ne(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),s=Object(i.a)(l,2),u=s[0],d=s[1],f=Object(n.useContext)(m).state,p=Object(n.useState)(!0),_=Object(i.a)(p,2),b=_[0],h=_[1],y=!1;return Object(n.useEffect)(function(){if(""!==f.user_email&&!y){y=!0;var e=$()();return e.emit("userId",f.user_email),e.on("userOrders",function(e){d(Object(j.a)(new Set(e.map(function(e){return"received"!==e.order_status?e.order_custom_id:null}).filter(function(e){return null!==e})))),c(e),h(!1)}),e.on("activeOrders",function(e){d(Object(j.a)(new Set(e.map(function(e){return"received"!==e.order_status?e.order_custom_id:null}).filter(function(e){return null!==e})))),c(e)}),e.emit("newOrder",a),function(){e.disconnect()}}},[f]),r.a.createElement(r.a.Fragment,null,r.a.createElement(B,{loading:b}),r.a.createElement("div",{className:"".concat(b&&"hazy")},r.a.createElement("h3",{className:"text-center py-3"},"Track Active Orders"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-center"},u.map(function(e){return r.a.createElement("div",{key:e,className:"card  myorder__items m-2 "},r.a.createElement("div",{className:"card-header bg-header"},r.a.createElement("h4",{className:"text-center"},"Order#",r.a.createElement("span",{className:"text-danger"}," ",e," "),"- Shop: ",r.a.createElement("span",{className:"text-primary"},Object(o.a)({},Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).Shop).name))),r.a.createElement("div",{className:"card-body d-flex  justify-content-between myorder__items ".concat("paid"===Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).order_status?"bg-paid":"bg-ready")},r.a.createElement("div",null,r.a.createElement("h5",{className:"m-1 p-0"},"Items"),a.filter(function(t){return t.order_custom_id===e}).map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("ul",{className:"p-1 m-0 list-unstyled"},r.a.createElement("li",null,r.a.createElement(r.a.Fragment,null,e.Menu.item_name,"x",e.item_qty))))})),r.a.createElement("div",null,r.a.createElement("h1",null,"$",Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).order_total),r.a.createElement("h5",null,"\u2022 ",Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).order_status))))}))))}function re(){var e=Object(s.f)(),t=Object(n.useContext)(m),a=t.dispatch,c=t.state;return Object(n.useEffect)(function(){var t=localStorage.getItem("conmmFete");null!==t?f.getThisUser(t).then(function(t){if("user"!==t.data.role)return e.replace("/".concat(t.data.role));a({type:"update_token",token:t.data.token}),a({type:"update_balance",balance:t.data.balance}),a({type:"update_role",role:t.data.role}),a({type:"update_email",email:t.data.email})}).catch(function(e){return console.warn(e)}):e.replace("/")},[]),r.a.createElement("div",{className:"container user__main"},r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(p,null),r.a.createElement(te,{state:c}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement("div",{className:"pt-2 px-2"},r.a.createElement(ne,null)),r.a.createElement("div",{id:"Order-now",className:"pt-4"})),r.a.createElement(q,null)))}function ce(){var e=Object(n.useReducer)(function(e,t){switch(t.type){case"update_token":return Object(o.a)({},e,{token:t.token});case"update_balance":return Object(o.a)({},e,{balance:t.balance});case"update_role":return Object(o.a)({},e,{role:t.role});case"update_email":return Object(o.a)({},e,{user_email:t.email});case"update_orderTotal":return Object(o.a)({},e,{orderTotal:t.orderTotal});case"refreshAPI":return Object(o.a)({},e,{refreshAPI:t.refreshAPI});case"updateBasket":return Object(o.a)({},e,{basket:t.basket});case"notifier":return Object(o.a)({},e,{display:t.display});default:return e}},{token:"",user_email:"",basket:{},role:"",orderTotal:0,balance:0,refreshAPI:!0,display:{class:"d-none",color:"",text:""}}),t=Object(i.a)(e,2),a=t[0],c=t[1];return r.a.createElement(m.Provider,{value:{state:a,dispatch:c}},r.a.createElement("div",{className:"App"},r.a.createElement(h.a,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",exact:!0},r.a.createElement(b,null)),r.a.createElement(s.a,{path:"/admin"},r.a.createElement(T,null)),r.a.createElement(s.a,{path:"/user"},r.a.createElement(P,null)),r.a.createElement(s.a,{path:"/checkout"},r.a.createElement(ae,null)),r.a.createElement(s.a,{path:"/order-tracker"},r.a.createElement(re,null)),r.a.createElement(s.a,{path:"/merchant"},r.a.createElement(Z,null)),r.a.createElement(s.a,{path:"*"},r.a.createElement(L,null))))))}var le=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function oe(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}l.a.render(r.a.createElement(ce,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");le?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):oe(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):oe(e)})}}()},64:function(e,t,a){e.exports=a(129)},69:function(e,t,a){},70:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){}},[[64,1,2]]]);
//# sourceMappingURL=main.8f7d15aa.chunk.js.map