(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(61),l=a.n(c),o=(a(69),a(3)),s=a(2),i=a(4),m=(a(70),Object(n.createContext)()),u=a(5),d=a.n(u),p={getUsers:function(e){return d()({method:"get",url:"/api/users",headers:{authorization:"bearer ".concat(e)}})},login:function(e,t){return d()({method:"post",url:"/api/login",data:{email:e.current.value,password:t.current.value}})},signup:function(e,t){return d()({method:"post",url:"/api/signup",data:{email:e.current.value,password:t.current.value}})},updateBalanceRole:function(e,t){return d()({method:"put",url:"/api/updateBalanceRole",headers:{authorization:"bearer ".concat(t)},data:e})},getShops:function(){return d()({method:"get",url:"/api/allshops"})},getMenu:function(e){return d()({method:"get",url:"/api/allmenu",headers:{authorization:"bearer ".concat(e)}})},getMenu_user:function(){return d()({method:"get",url:"/api/allmenu-users"})},createNewShop:function(e,t){return d()({method:"post",url:"/api/create-shop",headers:{authorization:"bearer ".concat(t)},data:e})},createMenuItem:function(e,t){return d()({method:"post",url:"/api/create-menu-item",headers:{authorization:"bearer ".concat(t)},data:e})},deleteMenuItem:function(e,t){return d()({method:"delete",url:"/api/delete-menu-item",headers:{authorization:"bearer ".concat(t)},data:e})},getThisUser:function(e){return d()({method:"get",url:"/api/get-this",headers:{authorization:"bearer ".concat(e)}})},processPayment:function(e,t){return d()({method:"post",url:"/api/processpayment",headers:{authorization:"bearer ".concat(t)},data:e})},getActiveOrders:function(e){return d()({method:"get",url:"/api/activeorders",headers:{authorization:"bearer ".concat(e)}})},getUserActiveOrders:function(e){return d()({method:"get",url:"/api/myactiveorders",headers:{authorization:"bearer ".concat(e)}})},getMerchantStats:function(e){return d()({method:"get",url:"/api/merchants/".concat(e)})},getAdminStats:function(e){return d()({method:"get",url:"/api/admin-stats",headers:{authorization:"bearer ".concat(e)}})},getAdminFooter:function(e){return d()({method:"get",url:"/api/admin-footer",headers:{authorization:"bearer ".concat(e)}})},getUserStats:function(e){return d()({method:"get",url:"/api/user-stats",headers:{authorization:"bearer ".concat(e)}})},getMerchantFooter:function(e){return d()({method:"get",url:"/api/merchant-footer",headers:{authorization:"bearer ".concat(e)}})}};a(88);function f(){var e=Object(n.useContext)(m).state.display;return r.a.createElement("div",{className:"notification animate__animated animate__bounceInDown  ".concat(e.color," ").concat(e.class)},r.a.createElement("p",{className:"p-3"},e.text))}a(89);function _(){return r.a.createElement("div",{className:"splash__main text-center animate__animated animate__zoomIn  d-flex flex-column justify-content-between"},r.a.createElement("div",null,r.a.createElement("h1",{className:" mt-4"},"Welcome"),r.a.createElement("h5",{className:" my-1"},"to"),r.a.createElement("img",{className:"d-block mx-auto",src:"./imgs/logo.png",alt:"logo"}),r.a.createElement("h3",{className:" my-1"},"Community Fete"),r.a.createElement("h1",null,"2021")),r.a.createElement("div",{className:"fete___photo__container"},r.a.createElement("img",{src:"./imgs/fete.png",alt:"fete",className:"fete__photo"})),r.a.createElement("p",null,"\xa9 Copyright 2021 , Developed by ",r.a.createElement("a",{href:"mailto:tonymelek.au@gmail.com",className:"text-purple"},"Tony Melek")))}function b(){var e=Object(n.useRef)(""),t=Object(n.useRef)(""),a=Object(i.f)(),c=Object(n.useContext)(m).dispatch,l=Object(n.useState)(!0),o=Object(s.a)(l,2),u=o[0],d=o[1];return Object(n.useEffect)(function(){setTimeout(function(){d(!1)},3e3)},[]),r.a.createElement("div",{className:"container "},u&&r.a.createElement(_,null),r.a.createElement("div",{className:"login__main"},r.a.createElement(f,null),!u&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"login card mx-auto p-3 mt-3"},r.a.createElement("h3",{className:"text-center mt-3"},"Login"),r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"login__email"},"Email"),r.a.createElement("input",{type:"email",name:"login__email",id:"login__email",ref:e,autoComplete:"email",placeholder:"your Email",className:"form-control"}),r.a.createElement("label",{htmlFor:"login__password"},"Password"),r.a.createElement("input",{type:"password",name:"login__password",id:"login__password",autoComplete:"current-password",ref:t,className:"form-control"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary my-2 w-100",onClick:function(n){return function(e,t,n){e.preventDefault(),p.login(t,n).then(function(e){c({type:"update_token",token:e.data.token}),c({type:"update_balance",balance:e.data.balance}),c({type:"update_role",role:e.data.role}),c({type:"update_email",email:e.data.email}),localStorage.setItem("conmmFete",e.data.token),c({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Logged-in Successfully"}}),a.push("/".concat(e.data.role)),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response.data)}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}(n,e,t)}},"Login"),r.a.createElement("p",{className:"fst-italic"},"If you do not have an account please Sign up first, You only need to enter your email and password")),r.a.createElement("button",{type:"submit",className:"btn btn-outline-primary my-2 w-100",onClick:function(n){return function(e,t,n){e.preventDefault(),p.signup(t,n).then(function(e){c({type:"update_token",token:e.data.token}),c({type:"update_balance",balance:e.data.balance}),c({type:"update_role",role:e.data.role}),c({type:"update_email",email:e.data.email}),localStorage.setItem("conmmFete",e.data.token),c({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Signed-up Successfully"}}),a.push("/".concat(e.data.role)),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response.data)}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}(n,e,t)}},"Sign Up")))))}var E=a(7);a(94);function h(){var e=Object(i.f)(),t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)([]),u=Object(s.a)(o,2),d=u[0],f=u[1],_=Object(n.useState)(""),b=Object(s.a)(_,2),E=b[0],h=b[1],y=Object(n.useContext)(m),g=y.dispatch,v=y.state,N={};Object(n.useEffect)(function(){""!==v.role&&("admin"!==v.role&&e.replace("/".concat(v.role)),p.getUsers(v.token).then(function(e){return l(e.data)}).catch(function(e){g({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){g({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}),p.getShops().then(function(e){return f(e.data)}).catch(function(e){g({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){g({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}))},[v]);var x=function(e,t,a){var n=c.filter(function(e){return e.email===t})[0];switch(a){case"role":n.role=e.target.value;break;case"balance":n.balance=parseInt(e.target.value);break;case"shop":n.ShopId=parseInt(e.target.value)}N[t]=n};return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"w-75 mx-auto"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"admin__search_input"},"Search Users"),r.a.createElement("input",{type:"text",autoComplete:"off",name:"admin__search_input",id:"admin__search_input",className:"form-control mb-2",onChange:function(e){return h(e.target.value)}}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex flex-row flex-wrap justify-content-around"},c.filter(function(e){return e.email.toLowerCase().includes(E.trim().toLowerCase())}).map(function(e){return r.a.createElement("div",{key:e.email,className:"admin__users  card m-2"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"text-center"}," ",e.email)),r.a.createElement("div",{className:"card-body d-flex flex-wrap justify-content-between align-items-center"},r.a.createElement("div",{className:"form-group d-flex justify-content-between align-items-center px-2 my-1 flex-grow-1"},r.a.createElement("p",{className:"px-2 m-0"},"Role "),r.a.createElement("select",{defaultValue:e.role,onChange:function(t){return x(t,e.email,"role")}},r.a.createElement("option",{value:"user"},"user"),r.a.createElement("option",{value:"merchant"},"merchant"))),"merchant"===e.role?r.a.createElement("div",{className:"form-group d-flex justify-content-between align-items-center p-2 my-2 flex-grow-1"},r.a.createElement("p",{className:"px-2 m-0"},"Shop "),r.a.createElement("select",{onChange:function(t){return x(t,e.email,"shop")}},r.a.createElement("option",{value:""}),d.map(function(t){return r.a.createElement("option",{key:"shop-".concat(t.id),value:t.id,selected:e.ShopId===t.id},t.name)}))):null,"user"===e.role?r.a.createElement("div",{className:"d-flex flex-row justify-content-between align-items-center my-2 p-2 flex-grow-1"},r.a.createElement("p",{className:"px-2 m-0"},"Top up Balance"),r.a.createElement("input",{type:"number",name:"user__topup",onChange:function(t){return x(t,e.email,"balance")},className:"admin__user__topup"})):null,r.a.createElement("button",{type:"submit",className:"btn btn-warning w-100",onClick:function(t){return function(e,t){e.preventDefault(),N[t]&&("merchant"===N[t].role?N[t].balance=0:N[t].ShopId=null,p.updateBalanceRole(N[t],v.token).then(function(e){g({type:"notifier",display:{class:"d-block",color:"bg-success",text:"User Updated Successfully"}}),setTimeout(function(){g({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){g({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){g({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}))}(t,e.email,e.balance)}},"Update")))}))))}function y(){var e=["Hot Food","Beverage","Kids","Deserts"].sort(),t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],l=a[1],u=Object(n.useState)({name:"",category:e[0]}),d=Object(s.a)(u,2),f=d[0],_=d[1],b=Object(n.useContext)(m),E=b.dispatch,h=b.state,y=Object(i.f)();Object(n.useEffect)(function(){""!==h.role&&("admin"!==h.role&&y.replace("/".concat(h.role)),p.getShops().then(function(e){return l(e.data)}).catch(function(e){E({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){E({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}))},[h]);return r.a.createElement("div",null,r.a.createElement("div",{className:"w-100 mx-auto"},r.a.createElement("div",{className:"card p-2"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"new__shop__name"},"Shop Name"),r.a.createElement("input",{type:"text",className:"form-control",name:"new__shop__name",id:"new__shop__name",onChange:function(e){return _(Object(o.a)({},f,{name:e.target.value.trim()}))}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"select__category"},"Category"),r.a.createElement("select",{name:"select__category",defaultValue:e[0],id:"select__category",className:"form-select",onChange:function(e){return _(Object(o.a)({},f,{category:e.target.value}))}},e.map(function(e,t){return r.a.createElement("option",{key:"category-".concat(t),value:e},e)}))),r.a.createElement("button",{className:"btn btn-primary my-3 ",type:"submit",onClick:function(){if(f.name.trim().length<2)return E({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Shop name can't be empty"}}),void setTimeout(function(){E({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3);p.createNewShop(f,h.token).then(function(t){_({name:"",category:e[0]}),E({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Shop created Successfully"}}),setTimeout(function(){E({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){E({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"".concat(e.response)}}),setTimeout(function(){E({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}},"Create Shop"))),r.a.createElement("h3",{className:"text-center my-3"},"Shops List"),r.a.createElement("div",{className:"card p-2 my-2"},r.a.createElement("ul",{className:"d-flex flex-wrap list-unstyled"},e.map(function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{className:"w-100",key:t},e),c.filter(function(t){return t.category===e}).map(function(e){return r.a.createElement("li",{key:"shops-".concat(e.id),className:"px-2 m-2 d-inline-flex bg-danger border-success rounded text-light"},e.name)}))}))))}var g=a(29),v=a(20),N=a(23);function x(e){var t=e.state,a=e.sideDisplay,n=a.side,c=a.setSide,l=Object(i.f)();return r.a.createElement("div",{className:"header__main "},r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement(g.a,{className:"BiMenu",onClick:function(){return c("d-none"===n?"d-block animate__animated animate__fadeInDown":"d-none")}}),r.a.createElement("div",{className:"d-flex align-items-center justify-content-center"},r.a.createElement("div",{className:"d-flex align-items-center cursor-pointer",onClick:function(){return l.push("/".concat(t.role))}},r.a.createElement(v.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"}," ",t.user_email," ")),r.a.createElement("div",{className:"d-flex flex-column p-1 align-items-center  justify-content-center cursor-pointer",onClick:function(){localStorage.removeItem("conmmFete"),l.replace("/")}},r.a.createElement(N.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"py-1 m-0"},"Logout")))))}a(95);function O(e){var t=e.side,a=e.items;return r.a.createElement("div",{className:"side__menu ".concat(t.side)},a.map(function(e){return r.a.createElement("div",{key:e,className:"side__menu__item py-2 px-5 m-2"},r.a.createElement("a",{href:"#".concat(e),onClick:function(){return t.setSide("d-none"===t.side?"d-block animate__animated animate__fadeInDown":"d-none")}},e.split("-").join(" ")))}))}var j=a(14);function k(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return l=e.done,e},e:function(e){o=!0,c=e},f:function(){try{l||null==a.return||a.return()}finally{if(o)throw c}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function w(e){var t=e.state,a=Object(n.useState)({}),c=Object(s.a)(a,2),l=c[0],i=c[1];return Object(n.useEffect)(function(){""!==t.token&&p.getAdminStats(t.token).then(function(e){var t=e.data;if(t.spend=e.data.totalSpend[0].total,1===e.data.highestSpender.length){var a=e.data.highestSpender[0];t.highestSpenderEmail=a.User.email,t.highestSpenderTotal=a.total}else t.highestSpenderEmail="no purchases yet",t.highestSpenderTotal=0;var n,r=t.orders,c={},l=k(Object(j.a)(new Set(r.map(function(e){return e.order_custom_id}))));try{var o=function(){var e=n.value,t=r.find(function(t){return t.order_custom_id===e});c[t.Shop.name]?(c[t.Shop.name].total+=t.order_total,c[t.Shop.name].orders++):c[t.Shop.name]={total:t.order_total,orders:1}};for(l.s();!(n=l.n()).done;)o()}catch(d){l.e(d)}finally{l.f()}console.log(c);var s,m=0;for(var u in c)c[u].total>m&&(m=c[u].total,s=u,c[u].orders);t.bestShop=c[s],t.bestShopName=s,i(t)}).catch(function(e){return console.log(e)})},[t]),r.a.createElement("div",{className:"admin__dashboard__main text-center"},r.a.createElement("h3",{className:"py-3"},"Admin Dashboard"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around pt-4"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Users"),r.a.createElement("h1",{className:"display-4  mt-4 text-danger"},l.numberOfUsers)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Merchants"),r.a.createElement("h1",{className:"mt-4 text-primary display-4"},l.numberOfMerchants)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Orders"),r.a.createElement("h1",{className:"display-4  mt-4 text-primary"},l.numberOfOrders)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Revenue"),r.a.createElement("h1",{className:"mt-4"},"$",r.a.createElement("span",{className:"display-4 text-danger"},l.spend>0?l.spend:0))),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Best Selling Shop"),r.a.createElement("h2",{className:"text-danger mt-2"},l.bestShopName),r.a.createElement("h3",null,"Orders# ",Object(o.a)({},l.bestShop).orders),r.a.createElement("h3",null,"Sales: $",r.a.createElement("span",{className:"text-danger"},Object(o.a)({},l.bestShop).total))),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Highest Spending User"),r.a.createElement("h2",{className:"mt-4"},l.highestSpenderEmail),r.a.createElement("h3",null,"Spent : $",r.a.createElement("span",{className:"text-danger"},l.highestSpenderTotal)))))}var C=a(24);function I(e){var t=e.state,a=Object(n.useState)({}),c=Object(s.a)(a,2),l=c[0],o=c[1],m=Object(i.f)();Object(n.useEffect)(function(){t.token.length<20||p.getAdminFooter(t.token).then(function(e){o(e.data)})},[t]);return r.a.createElement("div",{className:"merchant__footer__main py-2"},r.a.createElement("div",{className:"d-flex justify-content-around"},r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(C.b,{className:"FcShop"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null,l.shops," ")," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(v.c,{className:"GrDocumentTime "}),r.a.createElement("p",{className:"p-0 my-0 mx-2"}," ",r.a.createElement("strong",null," ",l.users)," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center",onClick:function(){m.push("/create-admin")}},r.a.createElement(N.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},"Create Admin "))))}function T(){var e=Object(n.useState)("d-none"),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(i.f)(),o=Object(n.useContext)(m),u=o.dispatch,d=o.state;return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?p.getThisUser(e).then(function(e){u({type:"update_token",token:e.data.token}),u({type:"update_balance",balance:e.data.balance}),u({type:"update_role",role:e.data.role}),u({type:"update_email",email:e.data.email})}).catch(function(e){return console.warn(e)}):l.replace("/")},[]),r.a.createElement("div",{className:"container admin__main"},r.a.createElement(f,null),r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(x,{state:d,sideDisplay:{side:a,setSide:c}}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement(O,{side:{side:a,setSide:c},items:["Dashboard","Manage-Shops","Manage-Users"]}),r.a.createElement("div",{className:"admin__component mx-2 mb-10",id:"Dashboard"},r.a.createElement(w,{state:d})),r.a.createElement("div",{className:"admin__component mx-2 mb-10",id:"Manage-Shops"},r.a.createElement(y,null)),r.a.createElement("div",{className:"admin__component mx-2 mb-10",id:"Manage-Users"},r.a.createElement(h,null))),r.a.createElement(I,{state:d})))}function F(e){var t=e.orders,a=e.state,c=Object(n.useState)({}),l=Object(s.a)(c,2),o=l[0],m=l[1],u=Object(i.f)();return Object(n.useEffect)(function(){""!==a.token&&p.getUserStats(a.token).then(function(e){console.log(e.data);var t=e.data;console.log(t),m({favourite_item:t.favourite.Menu.item_name,spent:t.spent.spent,totalOrders:t.totalOrders})}).catch(function(e){return console.log(e)})},[t]),r.a.createElement("div",{className:"user__dashboard__main text-center"},r.a.createElement("h3",{className:"py-3"},"User Dashboard"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around pt-4"},r.a.createElement("div",{className:"d-flex flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Orders"),r.a.createElement("h1",{className:"display-4  mt-4 text-danger"},o.totalOrders)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Favourite"),r.a.createElement("h3",{className:"mt-4 text-primary"},o.favourite_item))),r.a.createElement("div",{className:"d-flex  flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn cursor-pointer",onClick:function(){return u.push("/order-tracker")}},r.a.createElement("h3",null,"Active Orders"),r.a.createElement("h1",{className:"display-4  mt-4 text-primary"},t.length)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Spent"),r.a.createElement("h1",{className:"mt-4"},"$",r.a.createElement("span",{className:"display-4 text-danger"},o.spent))))))}var M=a(30);function D(){var e=Object(n.useContext)(m),t=e.state,a=e.dispatch,c=t.basket,l=Object(n.useState)(0),o=Object(s.a)(l,2),i=o[0],u=o[1];return Object(n.useEffect)(function(){var e=0;for(var t in c)e+=c[t].qty*c[t].price;u(e)},[t]),Object(n.useEffect)(function(){a({type:"update_orderTotal",orderTotal:i})},[i]),r.a.createElement("div",{className:"user__header2__main py-2"},r.a.createElement("div",{className:"d-flex justify-content-around"},r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(v.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null,Object.keys(t.basket).length," ")," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(C.a,{className:"AiOutlineDollar "}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},"Total:",r.a.createElement("strong",null,"$",i," ")," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(M.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null," $")," ",t.balance))))}function U(e){var t=e.history,a=Object(n.useContext)(m),c=a.dispatch,l=a.state,i=Object(n.useState)([]),u=Object(s.a)(i,2),d=u[0],f=u[1],_=["d-none","d-block"],b=l.basket,E=Object(n.useState)(""),h=Object(s.a)(E,2),y=h[0],v=h[1],N=Object(n.useState)([]),x=Object(s.a)(N,2),O=x[0],k=x[1];Object(n.useEffect)(function(){p.getMenu_user().then(function(e){f(e.data.map(function(e){return Object(o.a)({},e,{expand:!1,qty:0})})),k(Object(j.a)(new Set(e.data.filter(function(e){return e.item_name.toLowerCase()}).map(function(e){return e.Shop.category}))))}).catch(function(e){return console.log(e.response)})},[]);var S=function(e,t){f(d.map(function(a){if(a.id===e){var n=Object(o.a)({},a,{qty:"+"===t?a.qty+1:a.qty-1});return n.qty>0?(b[e]={id:e,qty:n.qty,item_name:n.item_name,price:n.price,ShopId:n.ShopId},n):(n=Object(o.a)({},a,{qty:0}),delete b[e],n)}return a})),c({type:"updateBasket",basket:b})};return r.a.createElement("div",{className:"user__menu__main px-4 "},r.a.createElement("form",{autoComplete:"off",onSubmit:function(e){return function(e){e.preventDefault()}(e)}},r.a.createElement("div",{className:"form-group my-2 pt-3 d-flex align-items-end"},r.a.createElement("div",{className:"flex-grow-1  mx-2"},r.a.createElement("label",{htmlFor:"search-item"},"Filter Items"),r.a.createElement("input",{type:"text",name:"search-item",value:y,id:"search-item",className:"form-control",onChange:function(e){v(e.target.value.trim().toLowerCase()),k(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(j.a)(new Set(d.filter(function(t){return t.item_name.toLowerCase().includes(e)}).map(function(e){return e.Shop.category})))}(e.target.value))}})),r.a.createElement("button",{className:"btn btn-primary mx-2",type:"submit"},r.a.createElement(g.b,null)))),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex flex-column justify-content-between"},r.a.createElement("div",{className:"user__menu__items"},O.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"card  bg-dark my-2 p-2   text-light cursor-pointer",onClick:function(){f(d.map(function(t){return t.Shop.category===e?Object(o.a)({},t,{expand:!t.expand}):t}))}},r.a.createElement("h5",null,e)),d.filter(function(e){return e.item_name.toLowerCase().includes(y)}).filter(function(t){return t.Shop.category===e}).map(function(e){return r.a.createElement("div",{key:e.id,className:"card  my-2 p-2 d-flex flex-row flex-wap justify-content-between animate__animated   animate__zoomIn ".concat(_[e.expand?1:0])},r.a.createElement("div",null,r.a.createElement("p",{className:"my-1"},r.a.createElement("strong",null,e.item_name),"-",e.serve),r.a.createElement("p",{className:"my-1"},e.item_desc),r.a.createElement("p",{className:"my-2"},"(",e.unit,") $",e.price),r.a.createElement("div",{className:"d-flex"},r.a.createElement("button",{className:"btn btn-dark",onClick:function(){return S(e.id,"-")}},"<"),r.a.createElement("input",{type:"number",value:e.qty,onChange:function(t){return function(e,t){var a=t.id,n=t.item_name,r=t.price,l=t.ShopId,s=parseInt(e.target.value);f(d.map(function(e){return e.id===a?Object(o.a)({},e,{qty:s}):e})),s>0?b[a]={id:a,qty:s,item_name:n,price:r,ShopId:l}:(f(d.map(function(e){return e.id===a?Object(o.a)({},e,{qty:0}):e})),delete b[a]),c({type:"updateBasket",basket:b})}(t,e)},className:"form-control mx-2 input__qty"}),r.a.createElement("button",{className:"btn btn-dark",onClick:function(){return S(e.id,"+")}},">"))),r.a.createElement("div",null,r.a.createElement("img",{src:e.item_pic,width:"100",alt:e.item_name})))}))})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",onClick:function(e){return function(e){if(e.preventDefault(),0===Object.keys(l.basket).length)return c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"You need to have at least one item in basket to proceed"}}),void setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3);t.push("/checkout")}(e)},className:"btn btn-success w-100 mb-3"},"Check out"))))}a(96);var q=a(13),A=a.n(q);a(123);function z(e){var t=e.loading;return r.a.createElement("div",{className:"loading__main"},t&&r.a.createElement("img",{src:"./imgs/loading.gif",alt:"loading"}))}function B(){var e=Object(n.useContext)(m),t=e.dispatch,a=e.state,c=Object(n.useState)([]),l=Object(s.a)(c,2),u=l[0],d=l[1],_=Object(n.useState)([]),b=Object(s.a)(_,2),E=(b[0],b[1]),h=Object(i.f)(),y=Object(n.useState)("d-none"),g=Object(s.a)(y,2),v=g[0],N=g[1],j=Object(n.useState)(!0),k=Object(s.a)(j,2),S=k[0],w=k[1];return Object(n.useEffect)(function(){var e=null;if(localStorage.getItem("conmmFete")&&(e=localStorage.getItem("conmmFete")),null!==e){var a=A()();p.getThisUser(e).then(function(e){return""!==e.data.role&&"user"!==e.data.role&&h.replace("/".concat(e.data.role)),p.getMenu_user().then(function(e){E(e.data.map(function(e){return Object(o.a)({},e,{expand:!1,qty:0})}))}).catch(function(e){return console.log(e.response)}),a.emit("userId",e.data.email),a.on("userOrders",function(e){console.log(e),d(e),w(!1)}),a.on("activeOrders",function(e){d(e)}),a.emit("newOrder",u),t({type:"update_token",token:e.data.token}),t({type:"update_balance",balance:e.data.balance}),t({type:"update_role",role:e.data.role}),t({type:"update_email",email:e.data.email}),function(){a.disconnect()}}).catch(function(e){return console.warn(e)})}else h.replace("/")},[]),r.a.createElement("div",{className:"container user__main"},r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(f,null),r.a.createElement(z,{loading:S}),r.a.createElement(x,{state:a,sideDisplay:{side:v,setSide:N}}),r.a.createElement("div",{className:"flex__main__components ".concat(S?"hazy":"")},r.a.createElement(O,{side:{side:v,setSide:N},items:["Dashboard","Order-now"]}),r.a.createElement("div",{className:"pt-4 user__dashboard",id:"Dashboard"},r.a.createElement(F,{orders:u,state:a})),r.a.createElement("div",{id:"Order-now",className:"pt-2"},r.a.createElement(U,{history:h}))),r.a.createElement(D,null)))}function $(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-center"},"Page is not found or you not allowed to view this page"))}a(124),a(125);function L(e){var t=e.values,a=Object(n.useState)({item_name:"",item_desc:"",unit:"each",serve:"sandwitch",price:0}),c=Object(s.a)(a,2),l=c[0],i=c[1],u=Object(n.useContext)(m),d=u.dispatch,f=u.state,_=Object(n.useState)(null),b=Object(s.a)(_,2),E=b[0],h=b[1];return r.a.createElement("div",{className:"create__menu__item ".concat(t.create_appear)},r.a.createElement("div",{className:"card m-3 create__menu__item__card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("p",{onClick:function(){t.setCreate_appear("d-none")},className:"text-right"},"X"),r.a.createElement("h4",{className:"text-center"},"Create New Menu Item")),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault();var a=l.item_name,n=l.item_desc,r=(l.unit,l.serve,l.price),c=new FormData;if(c.append("userPhoto",E),c.append("data",JSON.stringify(l)),a.length<2||n.length<2||r<=0)return d({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"All Fields are Mandatory, please fill and re-submit"}}),void setTimeout(function(){d({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3);p.createMenuItem(c,f.token).then(function(e){d({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Item created Successfully"}}),setTimeout(function(){d({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3),t.setCreate_appear("d-none")}).catch(function(e){d({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Error creating new Item"}}),setTimeout(function(){d({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)})}(e)}},r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_name"},"Item Name"),r.a.createElement("input",{type:"text",className:"form-control",name:"create_menu_name",id:"create_menu_name",onChange:function(e){return i(Object(o.a)({},l,{item_name:e.target.value.trim()}))}})),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_desc"},"Item Description"),r.a.createElement("input",{type:"text",className:"form-control",name:"create_menu_desc",id:"create_menu_desc",onChange:function(e){return i(Object(o.a)({},l,{item_desc:e.target.value.trim()}))}})),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_pic"},"Item Picture"),r.a.createElement("input",{type:"file",id:"photo",name:"file",className:"form-control",onChange:function(e){return function(e){h(e.target.files[0])}(e)}})),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:""},"Unit"),r.a.createElement("select",{defaultValue:"each",className:"form-select",name:"create_menu_unit",id:"create_menu_unit",onChange:function(e){return i(Object(o.a)({},l,{unit:e.target.value}))}},r.a.createElement("option",{value:"each"},"each"),r.a.createElement("option",{value:"100g"},"100g"))),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_serve"},"Serve"),r.a.createElement("select",{className:"form-select",name:"create_menu_serve",id:"create_menu_serve",onChange:function(e){return i(Object(o.a)({},l,{serve:e.target.value}))}},r.a.createElement("option",{value:"sandwitch"},"sandwitch"),r.a.createElement("option",{value:"cup"},"cup"),r.a.createElement("option",{value:"box"},"box"),r.a.createElement("option",{value:"ticket"},"ticket"))),r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("label",{htmlFor:"create_menu_price"},"Price"),r.a.createElement("input",{type:"number",className:"form-control",name:"create_menu_price",id:"create_menu_price",onChange:function(e){return i(Object(o.a)({},l,{price:e.target.value}))}})),r.a.createElement("button",{className:"btn btn-primary m-2",type:"submit"},"Create Item"))))}function R(e){var t=e.myOrders,a=(e.menu,Object(n.useState)(!1)),c=Object(s.a)(a,2),l=c[0],i=c[1],m=Object(j.a)(new Set(t.map(function(e){return"received"!==e.order_status?e.order_custom_id:null}).filter(function(e){return null!==e})));Object(n.useEffect)(function(){i(!1)},[t]);var u=function(e,t,a){e.preventDefault(),i(!0);var n=A()();n.emit("updateOrderStatus",{id:t,status:a}),setTimeout(function(){return n.close()},3e3)};return r.a.createElement("div",{className:"merchant__manage__orders__main"},r.a.createElement(z,{loading:l}),!l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"text-center py-3"},"Manage Orders"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around"},r.a.createElement("div",{className:"d-flex flex-wrap justify-content-center"},m.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"card  myorder__items m-2 "},r.a.createElement("div",{className:"card-header bg-header"},r.a.createElement("h4",{className:"text-center"},"Order#",r.a.createElement("span",{className:"text-danger"}," ",e," ")," ",r.a.createElement("span",{className:"text-primary"},Object(o.a)({},Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).User).email))),r.a.createElement("div",{className:"card-body  ".concat("paid"===Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status?"bg-paid":"bg-ready")},r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement("div",{className:"d-flex  justify-content-between myorder__items"},r.a.createElement("div",null,r.a.createElement("h5",null),r.a.createElement("h5",{className:"m-1 p-0"},"Items"),t.filter(function(t){return t.order_custom_id===e}).map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("ul",{className:"p-1 m-0 list-unstyled"},r.a.createElement("li",null,r.a.createElement(r.a.Fragment,null,e.Menu.item_name,"x",e.item_qty))))})),r.a.createElement("div",null,r.a.createElement("h1",null,"$",Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_total),r.a.createElement("h5",null,"\u2022 ",Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status))),r.a.createElement("div",null,"paid"===Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status&&r.a.createElement("button",{className:"btn btn-warning d-block w-100 my-2",onClick:function(t){return u(t,e,"ready")}},"Ready"),"ready"===Object(o.a)({},t.find(function(t){return t.order_custom_id===e})).order_status&&r.a.createElement("button",{className:"btn btn-success d-block w-100 my-2",onClick:function(t){return u(t,e,"received")}},"Collected"))))))})))))}function P(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useContext)(m),o=l.dispatch,i=l.state;Object(n.useEffect)(function(){""!==i.token&&p.getMenu(i.token).then(function(e){c(e.data)}).catch(function(e){return console.log(e.response)})},[i]);return r.a.createElement("div",{className:"mb-10 merchant__menu__main"},r.a.createElement("h3",{className:"text-center py-3"},"Menu Items"),a.filter(function(e){return e.availability}).map(function(e){return r.a.createElement("div",{key:e.id,className:"card m-2 p-2 d-flex flex-row flex-wap justify-content-between"},r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("strong",null,e.item_name)," - ",e.item_desc),r.a.createElement("p",null,e.unit,"-",e.serve,"-$",e.price),r.a.createElement("button",{onClick:function(t){return function(e,t){e.preventDefault(),p.deleteMenuItem({item_id:t},i.token).then(function(e){c(a.map(function(e){return e.id===t&&(e.availability=!1),e})),o({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Item deleted Successfully"}}),setTimeout(function(){o({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3)}).catch(function(e){o({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Error deleting Item"}}),setTimeout(function(){o({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3),console.log(e.response.data)})}(t,e.id)},className:"btn btn-danger",type:"submit"},"Delete Item")),r.a.createElement("div",null,r.a.createElement("img",{src:e.item_pic,height:"80",alt:e.item_name})))}))}var W=a(63);function J(e){var t=e.orders,a=e.state,c=Object(n.useState)({}),l=Object(s.a)(c,2),o=l[0],i=l[1];return Object(n.useEffect)(function(){""!==a.token&&(p.getMerchantFooter(a.token).then(function(e){return i({name:e.data.name,balance:e.data.balance})}),console.log(t))},[t]),r.a.createElement("div",{className:"merchant__footer__main py-2"},r.a.createElement("div",{className:"d-flex justify-content-around"},r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(C.b,{className:"FcShop"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null,o.name)," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(W.a,{className:"GrDocumentTime "}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},"Active : ",r.a.createElement("strong",null," ",t.length)," ")),r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement(M.a,{className:"AiOutlineDollar"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"},r.a.createElement("strong",null," $",o.balance)," "))))}a(126);function Y(e){var t=e.orders,a=e.menu,c=e.state,l=Object(n.useState)({}),o=Object(s.a)(l,2),i=o[0],m=o[1],u=Object(n.useState)(!0),d=Object(s.a)(u,2),f=d[0],_=d[1];return Object(n.useEffect)(function(){""!==c.user_email&&p.getMerchantStats(c.user_email).then(function(e){console.log(e.data),m({total:e.data.totalOrders,bestSeller:e.data.bestSeller[0].Menu.item_name,bestCount:e.data.bestSeller[0].item_count,merchantsCount:e.data.merchantsCount}),_(!1)}).catch(function(e){return console.log(e)})},[t]),r.a.createElement("div",{className:"merchant__dasboard__main text-center"},r.a.createElement(z,{loading:f}),!f&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"text-center py-3"},"Merchant Dashboard"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-around pt-4"},r.a.createElement("div",{className:"d-flex flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Total Orders"),r.a.createElement("h1",{className:"display-1 mt-4 text-danger"},i.total)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Best Seller"),r.a.createElement("h2",{className:"mt-3 text-primary"},i.bestSeller),r.a.createElement("h5",null,"Sold: ",i.bestCount))),r.a.createElement("div",{className:"d-flex  flex-grow-1 justify-content-around"},r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Menu Items"),r.a.createElement("h1",{className:"display-1 mt-4 text-primary"},a.filter(function(e){return e.availability}).length)),r.a.createElement("div",{className:"dashboard__item card animate__animated  animate__bounceIn"},r.a.createElement("h3",null,"Merchants"),r.a.createElement("h1",{className:"display-1 mt-4 text-danger"},i.merchantsCount))))))}function V(){var e=Object(n.useContext)(m),t=e.dispatch,a=e.state,c=Object(n.useState)("d-none"),l=Object(s.a)(c,2),o=l[0],u=l[1],d=Object(n.useState)("d-none"),_=Object(s.a)(d,2),b=_[0],E=_[1],h=Object(i.f)(),y=Object(n.useState)([]),g=Object(s.a)(y,2),v=g[0],N=g[1],j=Object(n.useState)([]),k=Object(s.a)(j,2),S=k[0],w=k[1];return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?p.getThisUser(e).then(function(e){""!==e.data.role&&"merchant"!==e.data.role&&h.replace("/".concat(e.data.role));var a=A()();return p.getMenu(e.data.token).then(function(e){N(e.data)}).catch(function(e){return console.log(e.response)}),a.emit("userId",e.data.email),a.on("shopConnection",function(e){console.log(e)}),a.on("shopOrders",function(e){w(e)}),t({type:"update_token",token:e.data.token}),t({type:"update_balance",balance:e.data.balance}),t({type:"update_role",role:e.data.role}),t({type:"update_email",email:e.data.email}),function(){return a.disconnect()}}).catch(function(e){return console.warn(e)}):h.replace("/")},[]),r.a.createElement("div",{className:"container merchant__main"},r.a.createElement(f,null),r.a.createElement(L,{values:{create_appear:o,setCreate_appear:u}}),r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(x,{state:a,sideDisplay:{side:b,setSide:E}}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement(O,{side:{side:b,setSide:E},items:["Dashboard","Manage-Orders","Update-Menu"]}),r.a.createElement("div",{className:" mx-2 merchant__section mb-10",id:"Dashboard"},r.a.createElement(Y,{orders:S,state:a,menu:v})),r.a.createElement("div",{className:" mx-2 merchant__section mb-10",id:"Manage-Orders"},r.a.createElement(R,{myOrders:S,menu:v})),r.a.createElement("div",{className:" merchant__section mb-10",id:"Update-Menu"},r.a.createElement("button",{onClick:function(){return u("d-block animate__animated animate__zoomIn ")},className:"btn btn-outline-danger create__new__item__button cursor-pointer"},"Create New Menu Item "),r.a.createElement(P,null))),r.a.createElement(J,{orders:S,state:a})))}a(127),a(128);function G(e){var t=e.props,a=t.state,c=t.dispatch,l=t.history,i=t.socketIOClient,m=Object(n.useState)([]),u=Object(s.a)(m,2),d=u[0],f=u[1],_=Object(n.useState)({}),b=Object(s.a)(_,2),E=b[0],h=b[1],y=Object(n.useState)({}),g=Object(s.a)(y,2),v=g[0],N=g[1],x=[],O={},j={};Object(n.useEffect)(function(){for(var e in a.basket){x.push(a.basket[e]);var t=Object(o.a)({},a.basket[e]);O[t.ShopId]?(O[t.ShopId].push({id:t.id,qty:t.qty}),j[t.ShopId]+=t.qty*t.price):(O[t.ShopId]=[{id:t.id,qty:t.qty}],j[t.ShopId]=t.qty*t.price)}f(x),h(O),N(j)},[a]);return r.a.createElement("div",{className:"revise__items__main d-flex flex-column justify-content-between"},r.a.createElement("div",{className:"resvise__items__list"},r.a.createElement("h2",null,"Items in Basket"),d.map(function(e){return r.a.createElement("div",{key:e.id,className:"card d-flex flex-row justify-content-between align-items-center p-2 m-1"},r.a.createElement("p",{className:"revised-item-width p-0 m-0"},r.a.createElement("strong",null,e.item_name)," x ",e.qty),r.a.createElement("p",{className:"p-0 m-0"},r.a.createElement("strong",null,"$"),e.qty*e.price," "),r.a.createElement("button",{className:"btn btn-danger",onClick:function(t){return function(e,t){e.preventDefault();var n=a.basket;delete n[t],c({type:"updateBasket",basket:n})}(t,e.id)},type:"submit"},"Remove"))})),r.a.createElement("div",{className:"checkout__button"},r.a.createElement("p",{className:"text-danger "}," **You may go back to edit quantities if required"),r.a.createElement("button",{className:"btn btn-success w-100",type:"submit",onClick:function(e){return function(e){if(e.preventDefault(),0===a.orderTotal)return c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Total should not be zero, you will be redirected to main page"}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3),l.replace("/user");var t=i();a.balance>=a.orderTotal?(p.processPayment({orders:JSON.stringify(E),subTotal:v,total:a.orderTotal},a.token).then(function(e){console.log(e.data),t.emit("newOrder",e.data),t.disconnect()}).catch(function(e){return console.log(e.response)}),c({type:"notifier",display:{class:"d-block",color:"bg-success",text:"Order Processed Successfully"}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}}),l.replace("/order-tracker")},2e3),c({type:"updateBasket",basket:{}})):(c({type:"notifier",display:{class:"d-block",color:"bg-danger",text:"Your Balance is insufficient"}}),setTimeout(function(){c({type:"notifier",display:{class:"d-none",color:"",text:""}})},2e3))}(e)}},"Pay Now \xa0\xa0\xa0\xa0$",a.orderTotal)))}function H(e){var t=e.state,a=Object(i.f)();return r.a.createElement("div",{className:"header__main "},r.a.createElement("div",{className:"d-flex justify-content-end header__flex__container"},r.a.createElement("div",{className:"d-flex align-items-center justify-content-center"},r.a.createElement("div",{className:"d-flex align-items-center cursor-pointer",onClick:function(){return a.push("/user")}},r.a.createElement(v.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"p-0 my-0 mx-2"}," ",t.user_email," ")),r.a.createElement("div",{className:"d-flex flex-column p-1 align-items-center justify-content-center cursor-pointer",onClick:function(){localStorage.removeItem("conmmFete"),a.replace("/")}},r.a.createElement(N.b,{className:"FaUserCircle"}),r.a.createElement("p",{className:"py-1 m-0"},"Logout")))))}function K(){var e=Object(n.useContext)(m),t=e.dispatch,a=e.state,c=Object(n.useState)([]),l=Object(s.a)(c,2),o=l[0],u=l[1],d=!1,_=Object(i.f)();return Object(n.useEffect)(function(){var e=localStorage.getItem("conmmFete");null!==e?p.getThisUser(e).then(function(e){t({type:"update_token",token:e.data.token}),t({type:"update_balance",balance:e.data.balance}),t({type:"update_role",role:e.data.role}),t({type:"update_email",email:e.data.email})}).catch(function(e){return console.warn(e)}):_.replace("/")},[]),Object(n.useEffect)(function(){if(""!==a.user_email&&!d){""!==a.role&&"user"!==a.role&&_.replace("/".concat(a.role)),d=!0;var e=A()();return e.emit("userId",a.user_email),e.on("userOrders",function(e){u(e)}),e.on("activeOrders",function(e){u(e)}),e.emit("newOrder",o),function(){e.disconnect()}}},[a]),r.a.createElement("div",{className:"container user__main"},r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(f,null),r.a.createElement(H,{state:a}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement("div",{className:"pt-2 px-2 user__revise"},r.a.createElement(G,{props:{state:a,dispatch:t,history:_,socketIOClient:A.a}})),r.a.createElement("div",{id:"Order-now",className:"pt-4"})),r.a.createElement(D,null)))}function X(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),i=Object(s.a)(l,2),u=i[0],d=i[1],p=Object(n.useContext)(m).state,f=Object(n.useState)(!0),_=Object(s.a)(f,2),b=_[0],E=_[1],h=!1;return Object(n.useEffect)(function(){if(""!==p.user_email&&!h){h=!0;var e=A()();return e.emit("userId",p.user_email),e.on("userOrders",function(e){d(Object(j.a)(new Set(e.map(function(e){return"received"!==e.order_status?e.order_custom_id:null}).filter(function(e){return null!==e})))),c(e),E(!1)}),e.on("activeOrders",function(e){d(Object(j.a)(new Set(e.map(function(e){return"received"!==e.order_status?e.order_custom_id:null}).filter(function(e){return null!==e})))),c(e)}),e.emit("newOrder",a),function(){e.disconnect()}}},[p]),r.a.createElement(r.a.Fragment,null,r.a.createElement(z,{loading:b}),r.a.createElement("div",{className:"".concat(b&&"hazy")},r.a.createElement("h3",{className:"text-center py-3"},"Track Active Orders"),r.a.createElement("div",{className:"d-flex flex-wrap justify-content-center"},u.map(function(e){return r.a.createElement("div",{key:e,className:"card  myorder__items m-2 "},r.a.createElement("div",{className:"card-header bg-header"},r.a.createElement("h4",{className:"text-center"},"Order#",r.a.createElement("span",{className:"text-danger"}," ",e," "),"- Shop: ",r.a.createElement("span",{className:"text-primary"},Object(o.a)({},Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).Shop).name))),r.a.createElement("div",{className:"card-body d-flex  justify-content-between myorder__items ".concat("paid"===Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).order_status?"bg-paid":"bg-ready")},r.a.createElement("div",null,r.a.createElement("h5",{className:"m-1 p-0"},"Items"),a.filter(function(t){return t.order_custom_id===e}).map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("ul",{className:"p-1 m-0 list-unstyled"},r.a.createElement("li",null,r.a.createElement(r.a.Fragment,null,e.Menu.item_name,"x",e.item_qty))))})),r.a.createElement("div",null,r.a.createElement("h1",null,"$",Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).order_total),r.a.createElement("h5",null,"\u2022 ",Object(o.a)({},a.find(function(t){return t.order_custom_id===e})).order_status))))}))))}function Q(){var e=Object(i.f)(),t=Object(n.useContext)(m),a=t.dispatch,c=t.state;return Object(n.useEffect)(function(){var t=localStorage.getItem("conmmFete");null!==t?p.getThisUser(t).then(function(t){if("user"!==t.data.role)return e.replace("/".concat(t.data.role));a({type:"update_token",token:t.data.token}),a({type:"update_balance",balance:t.data.balance}),a({type:"update_role",role:t.data.role}),a({type:"update_email",email:t.data.email})}).catch(function(e){return console.warn(e)}):e.replace("/")},[]),r.a.createElement("div",{className:"container user__main"},r.a.createElement("div",{className:"d-flex flex-column main__flex__container "},r.a.createElement(f,null),r.a.createElement(H,{state:c}),r.a.createElement("div",{className:"flex__main__components"},r.a.createElement("div",{className:"pt-2 px-2"},r.a.createElement(X,null)),r.a.createElement("div",{id:"Order-now",className:"pt-4"})),r.a.createElement(D,null)))}function Z(){var e=Object(n.useReducer)(function(e,t){switch(t.type){case"update_token":return Object(o.a)({},e,{token:t.token});case"update_balance":return Object(o.a)({},e,{balance:t.balance});case"update_role":return Object(o.a)({},e,{role:t.role});case"update_email":return Object(o.a)({},e,{user_email:t.email});case"update_orderTotal":return Object(o.a)({},e,{orderTotal:t.orderTotal});case"updateBasket":return Object(o.a)({},e,{basket:t.basket});case"notifier":return Object(o.a)({},e,{display:t.display});default:return e}},{token:"",user_email:"",basket:{},role:"",orderTotal:0,balance:0,display:{class:"d-none",color:"",text:""}}),t=Object(s.a)(e,2),a=t[0],c=t[1];return r.a.createElement(m.Provider,{value:{state:a,dispatch:c}},r.a.createElement("div",{className:"App"},r.a.createElement(E.a,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/",exact:!0},r.a.createElement(b,null)),r.a.createElement(i.a,{path:"/admin"},r.a.createElement(T,null)),r.a.createElement(i.a,{path:"/user"},r.a.createElement(B,null)),r.a.createElement(i.a,{path:"/checkout"},r.a.createElement(K,null)),r.a.createElement(i.a,{path:"/order-tracker"},r.a.createElement(Q,null)),r.a.createElement(i.a,{path:"/merchant"},r.a.createElement(V,null)),r.a.createElement(i.a,{path:"*"},r.a.createElement($,null))))))}var ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function te(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}l.a.render(r.a.createElement(Z,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");ee?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):te(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):te(e)})}}()},64:function(e,t,a){e.exports=a(129)},69:function(e,t,a){},70:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){}},[[64,1,2]]]);
//# sourceMappingURL=main.c9771dd5.chunk.js.map